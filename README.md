# Bar Straightening (合金丸棒の塑性変形シミュレーション)

## 概要 (Overview)
Unityを用いた、合金丸棒（シャフト）の塑性変形および弾性変形のインタラクティブな物理シミュレーションです。
オイラー・ベルヌーイの梁理論（Euler-Bernoulli beam theory）などの材料力学の概念をベースに、ユーザーが任意の角度・位置にシャフトを操作した状態でプレス機による荷重をかけると、リアルタイムな曲げ挙動（スプリングバックおよび降伏点を越えた永久ひずみ）を再現します。

## 特徴 (Features)
* **弾性変形と塑性変形の分離:** プレス機の荷重を受けている間の一時的な曲がり（Elastic）と、降伏点を越えて確定した戻らない曲がり（Plastic）を独立して計算し、スプリングバック現象を視覚的に表現しています。
* **正確なローカル/ワールド座標変換:** シャフト本体がどのように回転・移動していても、ワールド空間のプレス力を各ボーンのローカル座標系へと正確に逆変換（`InverseTransformDirection` およびクォータニオンの逆乗算）し、常に正しい軸に対する曲げモーメントを計算します。
* **ジンバルロックの回避:** オイラー角の順次回転による「不自然なねじれ」を防ぐため、X軸とZ軸の曲げ角度から合成ベクトルを算出し、`Quaternion.AngleAxis` を用いて単一の回転軸で一括処理する堅牢なロジックを実装しています。
* **動的な荷重分散:** プレス機のヘッド幅（ラムの幅）に応じて、接触点に近いボーンほど強く、遠いボーンほど弱く変形するようウェイト計算を行っています。

## 操作方法 (Controls)
* **[Space] キー:** プレス機（ラム）の降下（押し込み）。キーを離すと元の高さまで上昇します。
* **[←] / [→] キー (Horizontal):** シャフトを回転させ、曲げる面（角度）を調整します。
* **[↑] / [↓] キー (Vertical):** シャフトを長手方向にスライド移動させ、曲げる位置を調整します。

## 動作環境 (Environment)
* **Unity:** 2022.3 LTS 以降
* **Language:** C#

## パラメータ設定 (Customization)
Inspector上から以下の物理パラメータを調整することで、異なる材質の挙動をシミュレート可能です。
* `Press Force`: プレス機が押し込む力の強さ
* `Yield Point`: 降伏点（この角度以上の曲げが加わると塑性変形が始まります）
* `Plasticity Rate`: 塑性変形のしやすさ（オーバーフローした力の何割が永久ひずみになるか）
* `Spring Back Speed`: 弾性変形が元に戻るスピード

## 今後の展望 (To Do / Future Works)
* オイラー・ベルヌーイ梁理論のより厳密な曲げ曲線の適用と精度向上
* 熟練作業者の暗黙知抽出に向けたデータ取得・シミュレーション基盤としての拡張
* 複数回の曲げによる加工硬化（Yield Pointの上昇）の実装
